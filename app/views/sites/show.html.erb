<p id="notice"><%= notice %></p>

<div class="card">
  <h2 class="card-header bg-primary"><%= @site.name %></h2>
  <div class="card-body">

<p>
  <strong>Location: </strong>
  <%= @site.location %>
</p>

<% if current_user %>
	<% if can? :edit, Site %>
	<%= link_to 'Edit', edit_site_path(@site) %> |
	<% end %>
	<%= link_to 'Back', sites_path %>
<% end %>

<hr />
<h2>All Lap Times For This Venue</h2> 
<p>
	<table class="table table-striped table-bordered data-table">
		<thead>
			<tr class="warning">
				<th>Position</th>
				<th>Name</th>
				<th>Time</th>
			</tr>
		</thead>
		<tbody>
			<% i =1 %>
			<% lastScore = 0
			   lastPos = 0 
			%>
			<% @leaderboard.each do |participant| %>
			<tr>
				<% myPosition = i %>
				<% 
				if(lastScore > 0 && participant.lap_time == lastScore)
					myPosition = lastPos
				end
				lastScore = participant.lap_time
				lastPos = myPosition
				%>
				<td><%=myPosition%></td>
				<td><%=participant.user_name%></td>
				<td><%=participant.lap_time%> seconds</td>
			</tr>
			<%i +=1 %>
			<% end %>
		</tbody>

	</table>
</p>
</div></div>
