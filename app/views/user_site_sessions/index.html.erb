<p id="notice"><%= notice %></p>

<% if params.key?('showAll') == false %>
<h1>My Lap Times</h1>
<% else %>
<% if current_user.admin? %>
<h1>All Lap Times</h1>
<% else %>
<h1>My Lap Times</h1>
<% end %>
<% end %>

<table class="table table-striped table-bordered data-tables">
  <thead>
    <tr class="warning">
      <th>Lap Times</th>
      <th>User</th>
      <th>Venue</th>
      <th>Weather</th>
      <% if can? :limitedmanage, UserSiteSession %>
      <% i = 2 %>
      <% i += 1 if can? :delete, UserSiteSession %>
      <th colspan="<%=i%>"></th>
      <% end %>
    </tr>
  </thead>

  <tbody>
    <% @user_site_sessions.each do |user_site_session| %>
      <tr>
        <td><%= user_site_session.lap_time %></td>
        <td><%= user_site_session.user_name %></td>
        <td><%= user_site_session.venue_name %></td>
        <td><%= user_site_session.weather.humanize %></td>
        <% if can? :limitedmanage, UserSiteSession %>
        <td><%= link_to 'Show', user_site_session %></td>
        <% end %>
        <% if can? :limitedmanage, UserSiteSession %>
        <td><%= link_to 'Edit', edit_user_site_session_path(user_site_session) %></td>
        <% end %>
        <% if can? :delete, UserSiteSession %>
        <td><%= link_to 'Remove', user_site_session, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<% if can? :create, UserSiteSession %>
<%= link_to 'New User site session', new_user_site_session_path, class: 'btn btn-success' %>
<% end %>

<% if current_user.admin? %>
  <% if params.key?('showAll') == false %>
    <a href="/user_site_sessions?showAll" class="btn btn-info">Show All Lap Times</a>
  <% else %>
    <a href="/user_site_sessions" class="btn btn-info">Show My Lap Times</a>
  <% end %>
<% end %>